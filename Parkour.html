<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Platform Game</title>
  <style>
    body { 
      margin: 0; 
      overflow: hidden; 
      font-family: Arial, sans-serif;
    }
    canvas { 
      display: block; 
    }
    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      background: rgba(0,0,0,0.7);
      padding: 15px;
      border-radius: 5px;
      font-size: 14px;
    }
    canvas {
      cursor: default;
    }
  </style>
</head>

<body>
  <div id="info">
    <strong>Controls:</strong><br>
    WASD - Move<br>
    Space - Jump
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js">

  </script>
  
  <script>
    let scene
    let camera 
    let renderer
    let player
    let ground
    let keys = {};
    let velocity = new THREE.Vector3();
    let direction = new THREE.Vector3();
    let canJump = false;
    const GRAVITY = -30;
    const JUMP_FORCE = 15;
    const MOVE_SPEED = 20;

    function init() {
      // Scene
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x87ceeb);
      scene.fog = new THREE.Fog(0x87ceeb, 0, 100);

      // Camera
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.set(0, 15, 20);
      camera.lookAt(0, 0, 0);

      // Renderer
      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.shadowMap.enabled = true;
      document.body.appendChild(renderer.domElement);

      // Lighting
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);

      const dirLight = new THREE.DirectionalLight(0xffffff, 0.3);
      dirLight.position.set(5, 10, 5);
      dirLight.castShadow = true;
      dirLight.shadow.camera.left = -20;
      dirLight.shadow.camera.right = 20;
      dirLight.shadow.camera.top = 20;
      dirLight.shadow.camera.bottom = -20;
      scene.add(dirLight);

      // Ground
      const groundGeo = new THREE.BoxGeometry(50, 1, 50);
      const groundMat = new THREE.MeshStandardMaterial({ color: 0x2d5016 });
      ground = new THREE.Mesh(groundGeo, groundMat);
      ground.receiveShadow = true;
      ground.position.y = -0.5;
      scene.add(ground);

      // Player (cube character)
      const playerGeo = new THREE.BoxGeometry(1, 2, 1);
      const playerMat = new THREE.MeshStandardMaterial({ color: 0xff4444 });
      player = new THREE.Mesh(playerGeo, playerMat);
      player.castShadow = true;
      player.position.set(0, 3, 0);
      scene.add(player);

      // Event listeners
      document.addEventListener('keydown', (e) => keys[e.key.toLowerCase()] = true);
      document.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);
      window.addEventListener('resize', onWindowResize);
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function updatePlayer(delta) {
      // Apply gravity
      velocity.y += GRAVITY * delta;

      // Movement directions (fixed, not camera-relative)
      direction.set(0, 0, 0);
      
      if (keys['w']) direction.z -= 1;
      if (keys['s']) direction.z += 1;
      if (keys['a']) direction.x -= 1;
      if (keys['d']) direction.x += 1;

      if (direction.length() > 0) {
        direction.normalize();
        velocity.x = direction.x * MOVE_SPEED;
        velocity.z = direction.z * MOVE_SPEED;
      } else {
        velocity.x *= 0.9;
        velocity.z *= 0.9;
      }

      // Jump
      if (keys[' '] && canJump) {
        velocity.y = JUMP_FORCE;
        canJump = false;
      }

      // Update position
      player.position.x += velocity.x * delta;
      player.position.z += velocity.z * delta;
      player.position.y += velocity.y * delta;

      // Ground collision
      if (player.position.y <= 1) {
        player.position.y = 1;
        velocity.y = 0;
        canJump = true;
      }

      // Keep player in bounds
      player.position.x = Math.max(-24, Math.min(24, player.position.x));
      player.position.z = Math.max(-24, Math.min(24, player.position.z));
    }

    function animate() {
      requestAnimationFrame(animate);
      
      const delta = 0.016; // Approximately 60fps
      updatePlayer(delta);
      
      renderer.render(scene, camera);
    }

    init();
    animate();
  </script>
</body>
</html>
